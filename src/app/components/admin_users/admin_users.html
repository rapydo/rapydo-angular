
<div class='container-fluid'>
<div class="row justify-content-md-center">
<div class='col-12'>

<div class='card'>
<div class='card-header'>
	<h4 class='panel-title'>
		<i class='fa fa-users'></i> Users list
	</h4>
</div>

<div class='card-block'>

<loading *ngIf="loading"></loading>

<div class="table-responsive" *ngIf="!loading">

	<div class='container-fluid'>
	<div class='row'>
		<div class='col-6'>
			<input 
				type='text'
				style='padding:8px; margin-bottom:15px;'
				class='form-control'
				placeholder='Type to filter users'
				(keyup)='updateFilter($event)'
			>
		</div>
		<div class='col-6 text-right'>
			<button class="btn btn-secondary" (click)="create()">
				<i class='fas fa-plus'></i> new {{resource_name}}
			</button>
		</div>
	</div>
	</div>
	<div class="table-wrapper" #tableWrapper>
	<ngx-datatable
        class="bootstrap"
        [rows]="data"
        [columns]="columns"
		[columnMode]="ColumnMode.flex"
        [headerHeight]="40"
        [summaryRow]="true"
        [summaryPosition]="'bottom'"
        [footerHeight]="40"
        [limit]="paging.itemsPerPage"
        [rowHeight]="auto">
	</ngx-datatable>
	</div>

</div>
	<ng-template #dataRoles let-row="row" let-value="value" let-i="index">

		<span
			class='badge badge-info' style='margin-right:3px;'
			ngbTooltip="{{role['value']['description']}}"
			*ngFor="let role of value | iterate">
			{{role['value']['description']}}
		</span>	

	</ng-template>

	<ng-template #dataGroup let-row="row" let-value="value" let-i="index">

		<span ngbTooltip='{{value[0].fullname}}' *ngIf="value[0]">
	        {{value[0].shortname}}
        </span>
		<i
			class='fa fa-star'
			style='color:#FFD700;'
			*ngIf='row._coordinator'
			ngbTooltip="Coordinator of the group"
		></i>

	</ng-template>

	<ng-template #dataName let-row="row" let-value="value" let-i="index">

		{{row['name']}} {{row['surname']}}

	</ng-template>

	<ng-template #dataDate let-row="row" let-value="value" let-i="index">

		<span *ngIf='value' ngbTooltip="{{value | amFromUtc | date : 'dd MMM yyyy HH:mm:ss'}}">
			{{value | amFromUtc | date : 'dd MMM yyyy'}}
		</span>
		<span *ngIf='!value'>N/A</span>

	</ng-template>

	<ng-template #dataActive let-row="row" let-value="value" let-i="index">

		<i class='fa fa-check' *ngIf='value' style='color:green' ngbTooltip="This user is active"></i>
		<i class='fa fa-ban' *ngIf='!value' style='color:orange' ngbTooltip="This user is inactive"></i>

	</ng-template>


	<ng-template #emptyHeader let-column="column">
		&nbsp;
	</ng-template>

	<ng-template #controlsCell let-row="row" let-value="value" let-i="index">
		<i class='fa fa-edit fa-large' #icon_element (click)='update(row, icon_element)'></i>
		<i 
			class='fa fa-trash fa-large' style='color:red;'
			mwlConfirmationPopover
			[popoverTitle]="'Confirmation required'"
			[popoverMessage]="'Are you really sure you want to delete this user?'"
	        placement="left"
			(confirm)="remove(row.id)"
		></i>
	</ng-template>

	<ng-template #formModal let-c="close" let-d="dismiss">

	  <div class="modal-header bg-default">
	    <h4 class="modal-title">{{modalTitle}}</h4>
	    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
	      <span aria-hidden="true">&times;</span>
	    </button>
	  </div>
	  <div class="modal-body">
	  	<form [formGroup]="form" (ngSubmit)="submit()">
	  		<formly-form [form]="form" [fields]="fields" [model]="model">
		    <button type="submit" class="btn btn-default" [disabled]="updating">
			    <h4>Submit</h4>
		    </button>
	  		</formly-form>
  		</form>
	  </div>

	</ng-template>


</div>
</div>

</div>
</div>
</div>